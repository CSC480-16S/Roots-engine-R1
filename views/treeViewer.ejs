<!DOCTYPE html>
<html lang="en" ng-app="treeViewer">
<head>
    <meta charset="UTF-8">
    <title>Tree Viewer</title>
    <link href='https://fonts.googleapis.com/css?family=Andada' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto:500italic,300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="styles/normalize.css">
    <link rel="stylesheet" href="styles/treeStyles.css">
    <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="js/lodash.min.js"></script>
    <script src="js/dTree.min.js"></script>
    <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>

    <style>
        svg {
            font: 10px sans-serif;
        }
        .linage {
            fill: none;
            stroke: #000;
        }
        .marriage {
            fill: none;
            stroke: black;
        }
        .man {
            background-color: purple;
            border-style: solid;
            border-width: 1px;
        }
        .woman {
            background-color: brown;
            border-style: solid;
            border-width: 1px;
        }
        .emphasis{
            font-style: italic;
        }
        p {
            padding:0;
            margin:0;
        }

    </style>

</head>

<body>
<header>
    <a href="/treeViewer" class="header-logo">
        <img id="logo-img" src="images/logo.png">
    </a>

    <div class="dropdown">
        <input class="hamburger" type="image" src="images/hamburger.png" onclick="myFunction()">
        <div class="dropdown-content" id="Dropdown">
            <a href="/acountInfo">Account Info</a>
            <a href="map.ejs">Ancestory Distribution</a>
            <a href="/">Parliament Tree</a>
            <a href="mailto:rootsspammer@gmail.com">Contact Us</a>
            <a href="/about">About</a>
            <a href="/logout">Log Out</a>
        </div>
    </div>

    <script>
        function myFunction() {
            document.getElementById("Dropdown").classList.toggle("show");
        }
        window.onclick = function(e) {
            if (!e.target.matches('.hamburger')) {

                var dropdowns = document.getElementsByClassName("dropdown-content");
                for (var d = 0; d < dropdowns.length; d++) {
                    var openDropdown = dropdowns[d];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        }
    </script>
</header>

<div class="window" ng-controller="nodeTreeController">
    <div class="sidebar" ng-repeat="x in node">
        <div id="Profile Info">

            <figure class="profilePhoto">
                <img ng-src="http://i.imgur.com/{{x.image}}" alt="{{x.first_name}} {{x.last_name}}">
            </figure>

            <form action="/updateProfile" method="post">
                <div>
                    <div>
                        <label>Name: </label>
                        <p>{{x.first_name}} {{x.last_name}}</p>
                    </div>
                    <div>
                        <label>Gender: </label>
                        <p>{{x.gender}}</p>
                    </div>
                    <div>
                        <label>Date of Birth: </label>
                        <p>{{x.date_of_birth}}</p>
                    </div>
                    <div ng-hide="x.date_of_death == null">
                        <label>Date of Death: </label>
                        <p>{{x.date_of_death}}</p>
                    </div>
                    <div>
                        <label>Place of Birth: </label>
                        <p>{{x.municipality_of_birth}}, {{x.state_of_birth}}, {{x.country_of_birth}}</p>
                    </div>
                    <div ng-hide="x.country_of_death == null">
                        <label>Place of Death: </label>
                        <p>{{x.municipality_of_death}}, {{x.state_of_death}}, {{x.country_of_death}}</p>
                    </div>
                    <div>
                        <label>Bio: </label>
                        <p>{{x.bio}}</p>
                    </div>
                </div>

                <input class="profileButton" type="image" src="images/AddIcon.png" alt="Add">
                <input class="profileButton" type="image" src="images/EditIcon.png" alt="Edit">
                <input class="profileButton" type="image" src="images/DeleteIcon.png" alt="Delete">
                <a href="addPerson.ejs">add person</a>
            </form>
        </div>
    </div>

    <div id="graph"></div>
    <script>
        //will set the width and height of the container to be 70% and 50% respectively of the viewport.
        var viewPortWidth = (Math.max(document.documentElement.clientWidth, window.innerWidth || 0)-275)*.7;
        var wiewPortHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0)*.5;

        treeJson = d3.json("/getRelations", function (error, treeData) {
            dTree.init(treeData, {
                        width: viewPortWidth,
                        height: wiewPortHeight
                    }
            );
        });
    </script>

    <div id="map_toggle">
        <a href="/map">
            <img class="map_img" src="images/heatmapicon.png" >
        </a>
        <a href="/parliament">
            <img class="map_img" src="images/parliamenticon.png" >
        </a>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
<script src="js/login.js"></script>

<script>

    //Here is the controller that will display information of the node profile
    var app = angular.module("treeViewer",[]);
    app.controller('nodeTreeController',function($scope, $http){
        $http.get("/populateTree").then(function (response){
            $scope.node = response.data.user;
        });
    });

</script>

</body>
</html>
